/*
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the MIT License. See License.txt in the project root for license information.
*/

namespace Adxstudio.Xrm.Json
{
	using System;
	using System.Collections.Generic;
	using System.Linq;
	using System.Runtime.Serialization;
	using Adxstudio.Xrm.Services;
	using Adxstudio.Xrm.Services.Query;
	using Microsoft.Crm.Sdk.Messages;
	using Microsoft.Xrm.Client.Services;
	using Microsoft.Xrm.Sdk;
	using Microsoft.Xrm.Sdk.Discovery;
	using Microsoft.Xrm.Sdk.Messages;
	using Microsoft.Xrm.Sdk.Metadata;
	using Microsoft.Xrm.Sdk.Metadata.Query;
	using Microsoft.Xrm.Sdk.Query;

	/// <summary>
	/// Restricts serialization to as set of known types.
	/// </summary>
	public class CrmSerializationBinder : SerializationBinder
	{
		#region Serializable Types

		/// <summary>
		/// Serializable types.
		/// </summary>
		private static readonly Type[] AttributeTypes =
		{
			typeof(bool),
			typeof(bool[]),
			typeof(int),
			typeof(int[]),
			typeof(string),
			typeof(string[]),
			typeof(string[][]),
			typeof(double),
			typeof(double[]),
			typeof(decimal),
			typeof(decimal[]),
			typeof(Guid),
			typeof(Guid[]),
			typeof(DateTime),
			typeof(DateTime[]),
			typeof(Money),
			typeof(Money[]),
			typeof(EntityReference),
			typeof(EntityReference[]),
			typeof(OptionSetValue),
			typeof(OptionSetValue[]),
			typeof(EntityCollection),
			typeof(Money),
			typeof(Label),
			typeof(LocalizedLabel),
			typeof(LocalizedLabelCollection),
			typeof(EntityMetadata[]),
			typeof(EntityMetadata),
			typeof(AttributeMetadata[]),
			typeof(AttributeMetadata),
			typeof(RelationshipMetadataBase[]),
			typeof(RelationshipMetadataBase),
			typeof(EntityFilters),
			typeof(OptionSetMetadataBase),
			typeof(OptionSetMetadataBase[]),
			typeof(OptionSetMetadata),
			typeof(BooleanOptionSetMetadata),
			typeof(OptionSetType),
			typeof(ManagedPropertyMetadata),
			typeof(ManagedPropertyMetadata[]),
			typeof(BooleanManagedProperty),
			typeof(AttributeRequiredLevelManagedProperty)
		};

		/// <summary>
		/// Serializable types.
		/// </summary>
		private static readonly Type[] QueryTypes =
		{
			typeof(AliasedValue),
			typeof(Dictionary<string, string>),
			typeof(Entity),
			typeof(Entity[]),
			typeof(ColumnSet),
			typeof(EntityReferenceCollection),
			typeof(QueryBase),
			typeof(QueryExpression),
			typeof(QueryExpression[]),
			typeof(FilterExpression),
			typeof(FilterExpression[]),
			typeof(LocalizedLabel[]),
			typeof(PagingInfo),
			typeof(Relationship),
			typeof(AttributePrivilegeCollection),
			typeof(RelationshipQueryCollection),
			typeof(EntityMetadataCollection),
			typeof(OneToManyRelationshipMetadata[]),
			typeof(MetadataFilterExpression),
			typeof(MetadataConditionExpression),
			typeof(MetadataQueryBase),
			typeof(DeletedMetadataFilters),
			typeof(DeletedMetadataCollection),
			typeof(ExecuteMultipleSettings),
			typeof(OrganizationRequestCollection),
			typeof(OrganizationResponseCollection),
			typeof(ExecuteMultipleResponseItemCollection),
			typeof(QuickFindResultCollection),
			typeof(QuickFindConfigurationCollection),
			typeof(AttributeMappingCollection),
			typeof(MailboxTrackingFolderMappingCollection),
			typeof(Microsoft.Xrm.Sdk.Organization.OrganizationDetail),
			typeof(KeyAttributeCollection),
			typeof(BusinessEntityChanges),
			typeof(BusinessEntityChangesCollection),
			typeof(ConcurrencyBehavior),
			typeof(ChangeType),
			typeof(NewOrUpdatedItem),
			typeof(RemovedOrDeletedItem),
			typeof(EntityAttributeCollection),
			typeof(EmailEngagementAggregate),
			typeof(UserSearchFacet),
			typeof(UserSearchFacetCollection),
			typeof(UserSearchFacetResponseCollection)
		};

		/// <summary>
		/// Serializable types.
		/// </summary>
		private static readonly Type[] MetadataEnumTypes =
		{
			typeof(object[]),
			typeof(StringFormat),
			typeof(StringFormat[]),
			typeof(AttributeRequiredLevel),
			typeof(AttributeRequiredLevel[]),
			typeof(AttributeTypeCode),
			typeof(AttributeTypeCode[]),
			typeof(CascadeType),
			typeof(CascadeType[]),
			typeof(Microsoft.Xrm.Sdk.Metadata.DateTimeFormat),
			typeof(Microsoft.Xrm.Sdk.Metadata.DateTimeFormat[]),
			typeof(IntegerFormat),
			typeof(IntegerFormat[]),
			typeof(ManagedPropertyEvaluationPriority),
			typeof(ManagedPropertyEvaluationPriority[]),
			typeof(ManagedPropertyOperation),
			typeof(ManagedPropertyOperation[]),
			typeof(ManagedPropertyType),
			typeof(ManagedPropertyType[]),
			typeof(SecurityTypes),
			typeof(SecurityTypes[]),
			typeof(OwnershipTypes),
			typeof(OwnershipTypes[]),
			typeof(ImeMode),
			typeof(ImeMode[]),
			typeof(RelationshipType),
			typeof(RelationshipType[]),
			typeof(AttributeTypeDisplayName),
			typeof(AttributeTypeDisplayName[])
		};

		/// <summary>
		/// Serializable types defined within data contract <see cref="KnownTypeAttribute"/> attribute.
		/// </summary>
		private static readonly Type[] ContractKnownTypes =
		{
			typeof(AttributeMapping),
			typeof(AttributeMetadata),
			typeof(AttributePrivilege),
			typeof(AttributeQueryExpression),
			typeof(AttributeRequiredLevel),
			typeof(AttributeTypeDisplayName),
			typeof(BigIntAttributeMetadata),
			typeof(BooleanAttributeMetadata),
			typeof(BooleanManagedProperty),
			typeof(BooleanOptionSetMetadata),
			typeof(DateTimeAttributeMetadata),
			typeof(DateTimeBehavior),
			typeof(DecimalAttributeMetadata),
			typeof(DiscoveryServiceFault),
			typeof(DoubleAttributeMetadata),
			typeof(EntityKeyQueryExpression),
			typeof(EntityMetadata),
			typeof(EntityNameAttributeMetadata),
			typeof(EntityQueryExpression),
			typeof(ExecuteTransactionFault),
			typeof(FetchExpression),
			typeof(ImageAttributeMetadata),
			typeof(IntegerAttributeMetadata),
			typeof(LabelQueryExpression),
			typeof(LookupAttributeMetadata),
			typeof(MailboxTrackingFolderMapping),
			typeof(ManagedPropertyAttributeMetadata),
			typeof(ManyToManyRelationshipMetadata),
			typeof(MemoAttributeMetadata),
			typeof(MetadataQueryExpression),
			typeof(MoneyAttributeMetadata),
			typeof(OneToManyRelationshipMetadata),
			typeof(OptionSetMetadata),
			typeof(OrganizationServiceFault),
			typeof(PicklistAttributeMetadata),
			typeof(QueryByAttribute),
			typeof(QueryExpression),
			typeof(RelationshipMetadataBase),
			typeof(RelationshipQueryExpression),
			typeof(RetrieveOrganizationRequest),
			typeof(RetrieveOrganizationResponse),
			typeof(RetrieveOrganizationsRequest),
			typeof(RetrieveOrganizationsResponse),
			typeof(RetrieveUserIdByExternalIdRequest),
			typeof(RetrieveUserIdByExternalIdResponse),
			typeof(StateAttributeMetadata),
			typeof(StateOptionMetadata),
			typeof(StatusAttributeMetadata),
			typeof(StatusOptionMetadata),
			typeof(StringAttributeMetadata),
			typeof(StringFormatName),
			typeof(UniqueIdentifierAttributeMetadata),
		};

		/// <summary>
		/// Serializable types defined with <see cref="DataContractAttribute"/> attribute.
		/// </summary>
		private static readonly Type[] ContractTypes =
		{
			typeof(AliasedValue),
			typeof(AssociatedMenuBehavior),
			typeof(AssociatedMenuConfiguration),
			typeof(AssociatedMenuGroup),
			typeof(AssociateRequest),
			typeof(AssociateResponse),
			typeof(AttributeMapping),
			typeof(AttributeMetadata),
			typeof(AttributePrivilege),
			typeof(AttributeQueryExpression),
			typeof(AttributeRequiredLevel),
			typeof(AttributeRequiredLevelManagedProperty),
			typeof(AttributeTypeCode),
			typeof(AttributeTypeDisplayName),
			typeof(BaseServiceFault),
			typeof(BigIntAttributeMetadata),
			typeof(BooleanAttributeMetadata),
			typeof(BooleanManagedProperty),
			typeof(BooleanOptionSetMetadata),
			typeof(BusinessEntityChanges),
			typeof(CanBeReferencedRequest),
			typeof(CanBeReferencedResponse),
			typeof(CanBeReferencingRequest),
			typeof(CanBeReferencingResponse),
			typeof(CanManyToManyRequest),
			typeof(CanManyToManyResponse),
			typeof(CascadeConfiguration),
			typeof(CascadeType),
			typeof(ChangeType),
			typeof(ColumnSet),
			typeof(ConcurrencyBehavior),
			typeof(ConditionExpression),
			typeof(ConditionOperator),
			typeof(ConstantsBase<>),
			typeof(ConvertDateAndTimeBehaviorRequest),
			typeof(ConvertDateAndTimeBehaviorResponse),
			typeof(CreateAttributeRequest),
			typeof(CreateAttributeResponse),
			typeof(CreateCustomerRelationshipsRequest),
			typeof(CreateCustomerRelationshipsResponse),
			typeof(CreateEntityKeyRequest),
			typeof(CreateEntityKeyResponse),
			typeof(CreateEntityRequest),
			typeof(CreateEntityResponse),
			typeof(CreateManyToManyRequest),
			typeof(CreateManyToManyResponse),
			typeof(CreateOneToManyRequest),
			typeof(CreateOneToManyResponse),
			typeof(CreateOptionSetRequest),
			typeof(CreateOptionSetResponse),
			typeof(CreateRequest),
			typeof(CreateResponse),
			typeof(DateTimeAttributeMetadata),
			typeof(DateTimeBehavior),
			typeof(Microsoft.Xrm.Sdk.Metadata.DateTimeFormat),
			typeof(DecimalAttributeMetadata),
			typeof(DeleteAttributeRequest),
			typeof(DeleteAttributeResponse),
			typeof(DeletedMetadataFilters),
			typeof(DeleteEntityKeyRequest),
			typeof(DeleteEntityKeyResponse),
			typeof(DeleteEntityRequest),
			typeof(DeleteEntityResponse),
			typeof(DeleteOptionSetRequest),
			typeof(DeleteOptionSetResponse),
			typeof(DeleteOptionValueRequest),
			typeof(DeleteOptionValueResponse),
			typeof(DeleteRelationshipRequest),
			typeof(DeleteRelationshipResponse),
			typeof(DeleteRequest),
			typeof(DeleteResponse),
			typeof(DisassociateRequest),
			typeof(DisassociateResponse),
			typeof(DiscoveryRequest),
			typeof(DiscoveryResponse),
			typeof(DiscoveryServiceFault),
			typeof(DoubleAttributeMetadata),
			typeof(EndpointAccessType),
			typeof(EndpointType),
			typeof(Entity),
			typeof(EntityCollection),
			typeof(EntityFilters),
			typeof(EntityKeyIndexStatus),
			typeof(EntityKeyMetadata),
			typeof(EntityKeyQueryExpression),
			typeof(EntityMetadata),
			typeof(EntityNameAttributeMetadata),
			typeof(EntityQueryExpression),
			typeof(EntityReference),
			typeof(EntityRole),
			typeof(EntityState),
			typeof(EnumAttributeMetadata),
			typeof(ExecuteAsyncRequest),
			typeof(ExecuteAsyncResponse),
			typeof(ExecuteMultipleRequest),
			typeof(ExecuteMultipleResponse),
			typeof(ExecuteMultipleResponseItem),
			typeof(ExecuteMultipleSettings),
			typeof(ExecuteTransactionFault),
			typeof(ExecuteTransactionRequest),
			typeof(ExecuteTransactionResponse),
			typeof(FetchExpression),
			typeof(FilterExpression),
			typeof(GetValidManyToManyRequest),
			typeof(GetValidManyToManyResponse),
			typeof(GetValidReferencedEntitiesRequest),
			typeof(GetValidReferencedEntitiesResponse),
			typeof(GetValidReferencingEntitiesRequest),
			typeof(GetValidReferencingEntitiesResponse),
			typeof(ImageAttributeMetadata),
			typeof(ImeMode),
			typeof(InsertOptionValueRequest),
			typeof(InsertOptionValueResponse),
			typeof(InsertStatusValueRequest),
			typeof(InsertStatusValueResponse),
			typeof(IntegerAttributeMetadata),
			typeof(IntegerFormat),
			typeof(IsDataEncryptionActiveRequest),
			typeof(IsDataEncryptionActiveResponse),
			typeof(JoinOperator),
			typeof(Label),
			typeof(LabelQueryExpression),
			typeof(LinkEntity),
			typeof(LocalizedLabel),
			typeof(LogicalOperator),
			typeof(LookupAttributeMetadata),
			typeof(MailboxTrackingFolderMapping),
			typeof(ManagedProperty<>),
			typeof(ManagedPropertyAttributeMetadata),
			typeof(ManagedPropertyEvaluationPriority),
			typeof(ManagedPropertyMetadata),
			typeof(ManagedPropertyOperation),
			typeof(ManagedPropertyType),
			typeof(ManyToManyRelationshipMetadata),
			typeof(MemoAttributeMetadata),
			typeof(MetadataBase),
			typeof(MetadataConditionExpression),
			typeof(MetadataConditionOperator),
			typeof(MetadataFilterExpression),
			typeof(MetadataPropertiesExpression),
			typeof(MetadataQueryBase),
			typeof(MetadataQueryExpression),
			typeof(Money),
			typeof(MoneyAttributeMetadata),
			typeof(NewOrUpdatedItem),
			typeof(OneToManyRelationshipMetadata),
			typeof(OptionMetadata),
			typeof(OptionSetMetadata),
			typeof(OptionSetMetadataBase),
			typeof(OptionSetType),
			typeof(OptionSetValue),
			typeof(OrderExpression),
			typeof(OrderOptionRequest),
			typeof(OrderOptionResponse),
			typeof(OrderType),
			typeof(Microsoft.Xrm.Sdk.Organization.OrganizationDetail),
			typeof(OrganizationRelease),
			typeof(OrganizationRequest),
			typeof(OrganizationResponse),
			typeof(OrganizationServiceFault),
			typeof(OrganizationState),
			typeof(OwnershipTypes),
			typeof(PagingInfo),
			typeof(PicklistAttributeMetadata),
			typeof(PrivilegeType),
			typeof(QueryBase),
			typeof(QueryByAttribute),
			typeof(QueryExpression),
			typeof(QuickFindResult),
			typeof(ReactivateEntityKeyRequest),
			typeof(ReactivateEntityKeyResponse),
			typeof(Relationship),
			typeof(RelationshipMetadataBase),
			typeof(RelationshipQueryExpression),
			typeof(RelationshipType),
			typeof(RemoteExecutionContext),
			typeof(RemovedOrDeletedItem),
			typeof(RetrieveAllEntitiesRequest),
			typeof(RetrieveAllEntitiesResponse),
			typeof(RetrieveAllManagedPropertiesRequest),
			typeof(RetrieveAllManagedPropertiesResponse),
			typeof(RetrieveAllOptionSetsRequest),
			typeof(RetrieveAllOptionSetsResponse),
			typeof(RetrieveAttributeRequest),
			typeof(RetrieveAttributeResponse),
			typeof(RetrieveDataEncryptionKeyRequest),
			typeof(RetrieveDataEncryptionKeyResponse),
			typeof(RetrieveEntityChangesRequest),
			typeof(RetrieveEntityChangesResponse),
			typeof(RetrieveEntityKeyRequest),
			typeof(RetrieveEntityKeyResponse),
			typeof(RetrieveEntityRequest),
			typeof(RetrieveEntityResponse),
			typeof(RetrieveManagedPropertyRequest),
			typeof(RetrieveManagedPropertyResponse),
			typeof(RetrieveMetadataChangesRequest),
			typeof(RetrieveMetadataChangesResponse),
			typeof(RetrieveMultipleRequest),
			typeof(RetrieveMultipleResponse),
			typeof(RetrieveOptionSetRequest),
			typeof(RetrieveOptionSetResponse),
			typeof(RetrieveOrganizationRequest),
			typeof(RetrieveOrganizationResponse),
			typeof(RetrieveOrganizationsRequest),
			typeof(RetrieveOrganizationsResponse),
			typeof(RetrieveRelationshipRequest),
			typeof(RetrieveRelationshipResponse),
			typeof(RetrieveRequest),
			typeof(RetrieveResponse),
			typeof(RetrieveTimestampRequest),
			typeof(RetrieveTimestampResponse),
			typeof(RetrieveUserIdByExternalIdRequest),
			typeof(RetrieveUserIdByExternalIdResponse),
			typeof(SecurityPrivilegeMetadata),
			typeof(SecurityTypes),
			typeof(ServiceEndpointFault),
			typeof(SetDataEncryptionKeyRequest),
			typeof(SetDataEncryptionKeyResponse),
			typeof(StateAttributeMetadata),
			typeof(StateOptionMetadata),
			typeof(StatusAttributeMetadata),
			typeof(StatusOptionMetadata),
			typeof(StringAttributeMetadata),
			typeof(StringFormat),
			typeof(StringFormatName),
			typeof(UniqueIdentifierAttributeMetadata),
			typeof(UpdateAttributeRequest),
			typeof(UpdateAttributeResponse),
			typeof(UpdateEntityRequest),
			typeof(UpdateEntityResponse),
			typeof(UpdateOptionSetRequest),
			typeof(UpdateOptionSetResponse),
			typeof(UpdateOptionValueRequest),
			typeof(UpdateOptionValueResponse),
			typeof(UpdateRelationshipRequest),
			typeof(UpdateRelationshipResponse),
			typeof(UpdateRequest),
			typeof(UpdateResponse),
			typeof(UpdateStateValueRequest),
			typeof(UpdateStateValueResponse),
			typeof(UpsertRequest),
			typeof(UpsertResponse),
		};

		/// <summary>
		/// Serializable types.
		/// </summary>
		private static readonly Type[] ProxyTypes =
		{
			typeof(AccessRights),
			typeof(AddChannelAccessProfilePrivilegesRequest),
			typeof(AddChannelAccessProfilePrivilegesResponse),
			typeof(AddItemCampaignActivityRequest),
			typeof(AddItemCampaignActivityResponse),
			typeof(AddItemCampaignRequest),
			typeof(AddItemCampaignResponse),
			typeof(AddListMembersListRequest),
			typeof(AddListMembersListResponse),
			typeof(AddMemberListRequest),
			typeof(AddMemberListResponse),
			typeof(AddMembersTeamRequest),
			typeof(AddMembersTeamResponse),
			typeof(AddPrincipalToQueueRequest),
			typeof(AddPrincipalToQueueResponse),
			typeof(AddPrivilegesRoleRequest),
			typeof(AddPrivilegesRoleResponse),
			typeof(AddProductToKitRequest),
			typeof(AddProductToKitResponse),
			typeof(AddRecurrenceRequest),
			typeof(AddRecurrenceResponse),
			typeof(AddSolutionComponentRequest),
			typeof(AddSolutionComponentResponse),
			typeof(AddSubstituteProductRequest),
			typeof(AddSubstituteProductResponse),
			typeof(AddToQueueRequest),
			typeof(AddToQueueResponse),
			typeof(AddUserToRecordTeamRequest),
			typeof(AddUserToRecordTeamResponse),
			typeof(ApplyRecordCreationAndUpdateRuleRequest),
			typeof(ApplyRecordCreationAndUpdateRuleResponse),
			typeof(ApplyRoutingRuleRequest),
			typeof(ApplyRoutingRuleResponse),
			typeof(AppointmentProposal),
			typeof(AppointmentRequest),
			typeof(AppointmentsToIgnore),
			typeof(AssignRequest),
			typeof(AssignResponse),
			typeof(AssociateEntitiesRequest),
			typeof(AssociateEntitiesResponse),
			typeof(AttributeAuditDetail),
			typeof(AuditDetail),
			typeof(AuditDetailCollection),
			typeof(AuditPartitionDetail),
			typeof(AutoMapEntityRequest),
			typeof(AutoMapEntityResponse),
			typeof(BackgroundSendEmailRequest),
			typeof(BackgroundSendEmailResponse),
			typeof(BookRequest),
			typeof(BookResponse),
			typeof(BulkDeleteRequest),
			typeof(BulkDeleteResponse),
			typeof(BulkDetectDuplicatesRequest),
			typeof(BulkDetectDuplicatesResponse),
			typeof(BulkOperationSource),
			typeof(BusinessNotification),
			typeof(CalculateActualValueOpportunityRequest),
			typeof(CalculateActualValueOpportunityResponse),
			typeof(CalculatePriceRequest),
			typeof(CalculatePriceResponse),
			typeof(CalculateRollupFieldRequest),
			typeof(CalculateRollupFieldResponse),
			typeof(CalculateTotalTimeIncidentRequest),
			typeof(CalculateTotalTimeIncidentResponse),
			typeof(CancelContractRequest),
			typeof(CancelContractResponse),
			typeof(CancelSalesOrderRequest),
			typeof(CancelSalesOrderResponse),
			typeof(ChannelAccessProfilePrivilege),
			typeof(ChannelAccessProfilePrivilegeDepth),
			typeof(ChannelAccessProfileWithPrivileges),
			typeof(CheckIncomingEmailRequest),
			typeof(CheckIncomingEmailResponse),
			typeof(CheckPromoteEmailRequest),
			typeof(CheckPromoteEmailResponse),
			typeof(CloneAsPatchRequest),
			typeof(CloneAsPatchResponse),
			typeof(CloneAsSolutionRequest),
			typeof(CloneAsSolutionResponse),
			typeof(CloneContractRequest),
			typeof(CloneContractResponse),
			typeof(CloneMobileOfflineProfileRequest),
			typeof(CloneMobileOfflineProfileResponse),
			typeof(CloneProductRequest),
			typeof(CloneProductResponse),
			typeof(CloseIncidentRequest),
			typeof(CloseIncidentResponse),
			typeof(CloseQuoteRequest),
			typeof(CloseQuoteResponse),
			typeof(ComponentDetail),
			typeof(CompoundCreateRequest),
			typeof(CompoundCreateResponse),
			typeof(CompoundUpdateDuplicateDetectionRuleRequest),
			typeof(CompoundUpdateDuplicateDetectionRuleResponse),
			typeof(CompoundUpdateRequest),
			typeof(CompoundUpdateResponse),
			typeof(ConstraintRelation),
			typeof(ConvertKitToProductRequest),
			typeof(ConvertKitToProductResponse),
			typeof(ConvertOwnerTeamToAccessTeamRequest),
			typeof(ConvertOwnerTeamToAccessTeamResponse),
			typeof(ConvertProductToKitRequest),
			typeof(ConvertProductToKitResponse),
			typeof(ConvertQuoteToSalesOrderRequest),
			typeof(ConvertQuoteToSalesOrderResponse),
			typeof(ConvertSalesOrderToInvoiceRequest),
			typeof(ConvertSalesOrderToInvoiceResponse),
			typeof(CopyCampaignRequest),
			typeof(CopyCampaignResponse),
			typeof(CopyCampaignResponseRequest),
			typeof(CopyCampaignResponseResponse),
			typeof(CopyDynamicListToStaticRequest),
			typeof(CopyDynamicListToStaticResponse),
			typeof(CopyMembersListRequest),
			typeof(CopyMembersListResponse),
			typeof(CopySystemFormRequest),
			typeof(CopySystemFormResponse),
			typeof(CreateActivitiesListRequest),
			typeof(CreateActivitiesListResponse),
			typeof(CreateExceptionRequest),
			typeof(CreateExceptionResponse),
			typeof(CreateInstanceRequest),
			typeof(CreateInstanceResponse),
			typeof(CreateKnowledgeArticleTranslationRequest),
			typeof(CreateKnowledgeArticleTranslationResponse),
			typeof(CreateKnowledgeArticleVersionRequest),
			typeof(CreateKnowledgeArticleVersionResponse),
			typeof(CreateWorkflowFromTemplateRequest),
			typeof(CreateWorkflowFromTemplateResponse),
			typeof(DeleteAndPromoteRequest),
			typeof(DeleteAndPromoteResponse),
			typeof(DeleteAuditDataRequest),
			typeof(DeleteAuditDataResponse),
			typeof(DeleteOpenInstancesRequest),
			typeof(DeleteOpenInstancesResponse),
			typeof(DeliverIncomingEmailRequest),
			typeof(DeliverIncomingEmailResponse),
			typeof(DeliverPromoteEmailRequest),
			typeof(DeliverPromoteEmailResponse),
			typeof(DeprovisionLanguageRequest),
			typeof(DeprovisionLanguageResponse),
			typeof(DisassociateEntitiesRequest),
			typeof(DisassociateEntitiesResponse),
			typeof(DistributeCampaignActivityRequest),
			typeof(DistributeCampaignActivityResponse),
			typeof(DownloadReportDefinitionRequest),
			typeof(DownloadReportDefinitionResponse),
			typeof(EntitySource),
			typeof(ErrorInfo),
			typeof(ExecuteByIdSavedQueryRequest),
			typeof(ExecuteByIdSavedQueryResponse),
			typeof(ExecuteByIdUserQueryRequest),
			typeof(ExecuteByIdUserQueryResponse),
			typeof(ExecuteFetchRequest),
			typeof(ExecuteFetchResponse),
			typeof(ExecuteWorkflowRequest),
			typeof(ExecuteWorkflowResponse),
			typeof(ExpandCalendarRequest),
			typeof(ExpandCalendarResponse),
			typeof(ExportDynamicToExcelType),
			typeof(ExportFieldTranslationRequest),
			typeof(ExportFieldTranslationResponse),
			typeof(ExportMappingsImportMapRequest),
			typeof(ExportMappingsImportMapResponse),
			typeof(ExportSolutionRequest),
			typeof(ExportSolutionResponse),
			typeof(ExportTranslationRequest),
			typeof(ExportTranslationResponse),
			typeof(FetchXmlToQueryExpressionRequest),
			typeof(FetchXmlToQueryExpressionResponse),
			typeof(FindParentResourceGroupRequest),
			typeof(FindParentResourceGroupResponse),
			typeof(FulfillSalesOrderRequest),
			typeof(FulfillSalesOrderResponse),
			typeof(FullTextSearchKnowledgeArticleRequest),
			typeof(FullTextSearchKnowledgeArticleResponse),
			typeof(GenerateInvoiceFromOpportunityRequest),
			typeof(GenerateInvoiceFromOpportunityResponse),
			typeof(GenerateQuoteFromOpportunityRequest),
			typeof(GenerateQuoteFromOpportunityResponse),
			typeof(GenerateSalesOrderFromOpportunityRequest),
			typeof(GenerateSalesOrderFromOpportunityResponse),
			typeof(GenerateSocialProfileRequest),
			typeof(GenerateSocialProfileResponse),
			typeof(GetAllTimeZonesWithDisplayNameRequest),
			typeof(GetAllTimeZonesWithDisplayNameResponse),
			typeof(GetDecryptionKeyRequest),
			typeof(GetDecryptionKeyResponse),
			typeof(GetDefaultPriceLevelRequest),
			typeof(GetDefaultPriceLevelResponse),
			typeof(GetDistinctValuesImportFileRequest),
			typeof(GetDistinctValuesImportFileResponse),
			typeof(GetHeaderColumnsImportFileRequest),
			typeof(GetHeaderColumnsImportFileResponse),
			typeof(GetInvoiceProductsFromOpportunityRequest),
			typeof(GetInvoiceProductsFromOpportunityResponse),
			typeof(GetQuantityDecimalRequest),
			typeof(GetQuantityDecimalResponse),
			typeof(GetQuoteProductsFromOpportunityRequest),
			typeof(GetQuoteProductsFromOpportunityResponse),
			typeof(GetReportHistoryLimitRequest),
			typeof(GetReportHistoryLimitResponse),
			typeof(GetSalesOrderProductsFromOpportunityRequest),
			typeof(GetSalesOrderProductsFromOpportunityResponse),
			typeof(GetTimeZoneCodeByLocalizedNameRequest),
			typeof(GetTimeZoneCodeByLocalizedNameResponse),
			typeof(GetTrackingTokenEmailRequest),
			typeof(GetTrackingTokenEmailResponse),
			typeof(GrantAccessRequest),
			typeof(GrantAccessResponse),
			typeof(ImportFieldTranslationRequest),
			typeof(ImportFieldTranslationResponse),
			typeof(ImportMappingsImportMapRequest),
			typeof(ImportMappingsImportMapResponse),
			typeof(ImportRecordsImportRequest),
			typeof(ImportRecordsImportResponse),
			typeof(ImportSolutionRequest),
			typeof(ImportSolutionResponse),
			typeof(ImportTranslationRequest),
			typeof(ImportTranslationResponse),
			typeof(IncrementKnowledgeArticleViewCountRequest),
			typeof(IncrementKnowledgeArticleViewCountResponse),
			typeof(InitializeFromRequest),
			typeof(InitializeFromResponse),
			typeof(InputArgumentCollection),
			typeof(InstallSampleDataRequest),
			typeof(InstallSampleDataResponse),
			typeof(InstantiateFiltersRequest),
			typeof(InstantiateFiltersResponse),
			typeof(InstantiateTemplateRequest),
			typeof(InstantiateTemplateResponse),
			typeof(IsBackOfficeInstalledRequest),
			typeof(IsBackOfficeInstalledResponse),
			typeof(IsComponentCustomizableRequest),
			typeof(IsComponentCustomizableResponse),
			typeof(IsValidStateTransitionRequest),
			typeof(IsValidStateTransitionResponse),
			typeof(LocalTimeFromUtcTimeRequest),
			typeof(LocalTimeFromUtcTimeResponse),
			typeof(LockInvoicePricingRequest),
			typeof(LockInvoicePricingResponse),
			typeof(LockSalesOrderPricingRequest),
			typeof(LockSalesOrderPricingResponse),
			typeof(LoseOpportunityRequest),
			typeof(LoseOpportunityResponse),
			typeof(MakeAvailableToOrganizationReportRequest),
			typeof(MakeAvailableToOrganizationReportResponse),
			typeof(MakeAvailableToOrganizationTemplateRequest),
			typeof(MakeAvailableToOrganizationTemplateResponse),
			typeof(MakeUnavailableToOrganizationReportRequest),
			typeof(MakeUnavailableToOrganizationReportResponse),
			typeof(MakeUnavailableToOrganizationTemplateRequest),
			typeof(MakeUnavailableToOrganizationTemplateResponse),
			typeof(MergeRequest),
			typeof(MergeResponse),
			typeof(MissingComponent),
			typeof(ModifyAccessRequest),
			typeof(ModifyAccessResponse),
			typeof(ObjectiveRelation),
			typeof(OrganizationResources),
			typeof(ParseImportRequest),
			typeof(ParseImportResponse),
			typeof(PickFromQueueRequest),
			typeof(PickFromQueueResponse),
			typeof(PrincipalAccess),
			typeof(PrivilegeDepth),
			typeof(ProcessInboundEmailRequest),
			typeof(ProcessInboundEmailResponse),
			typeof(PropagateByExpressionRequest),
			typeof(PropagateByExpressionResponse),
			typeof(PropagationOwnershipOptions),
			typeof(ProposalParty),
			typeof(ProvisionLanguageRequest),
			typeof(ProvisionLanguageResponse),
			typeof(PublishAllXmlRequest),
			typeof(PublishAllXmlResponse),
			typeof(PublishDuplicateRuleRequest),
			typeof(PublishDuplicateRuleResponse),
			typeof(PublishProductHierarchyRequest),
			typeof(PublishProductHierarchyResponse),
			typeof(PublishThemeRequest),
			typeof(PublishThemeResponse),
			typeof(PublishXmlRequest),
			typeof(PublishXmlResponse),
			typeof(QualifyLeadRequest),
			typeof(QualifyLeadResponse),
			typeof(QualifyMemberListRequest),
			typeof(QualifyMemberListResponse),
			typeof(QueryExpressionToFetchXmlRequest),
			typeof(QueryExpressionToFetchXmlResponse),
			typeof(QueryMultipleSchedulesRequest),
			typeof(QueryMultipleSchedulesResponse),
			typeof(QueryScheduleRequest),
			typeof(QueryScheduleResponse),
			typeof(ReassignObjectsOwnerRequest),
			typeof(ReassignObjectsOwnerResponse),
			typeof(ReassignObjectsSystemUserRequest),
			typeof(ReassignObjectsSystemUserResponse),
			typeof(RecalculateRequest),
			typeof(RecalculateResponse),
			typeof(RelationshipAuditDetail),
			typeof(ReleaseToQueueRequest),
			typeof(ReleaseToQueueResponse),
			typeof(RemoveFromQueueRequest),
			typeof(RemoveFromQueueResponse),
			typeof(RemoveItemCampaignActivityRequest),
			typeof(RemoveItemCampaignActivityResponse),
			typeof(RemoveItemCampaignRequest),
			typeof(RemoveItemCampaignResponse),
			typeof(RemoveMemberListRequest),
			typeof(RemoveMemberListResponse),
			typeof(RemoveMembersTeamRequest),
			typeof(RemoveMembersTeamResponse),
			typeof(RemoveParentRequest),
			typeof(RemoveParentResponse),
			typeof(RemovePrivilegeRoleRequest),
			typeof(RemovePrivilegeRoleResponse),
			typeof(RemoveProductFromKitRequest),
			typeof(RemoveProductFromKitResponse),
			typeof(RemoveRelatedRequest),
			typeof(RemoveRelatedResponse),
			typeof(RemoveSolutionComponentRequest),
			typeof(RemoveSolutionComponentResponse),
			typeof(RemoveSubstituteProductRequest),
			typeof(RemoveSubstituteProductResponse),
			typeof(RemoveUserFromRecordTeamRequest),
			typeof(RemoveUserFromRecordTeamResponse),
			typeof(RenewContractRequest),
			typeof(RenewContractResponse),
			typeof(RenewEntitlementRequest),
			typeof(RenewEntitlementResponse),
			typeof(ReplacePrivilegesRoleRequest),
			typeof(ReplacePrivilegesRoleResponse),
			typeof(RequiredResource),
			typeof(RescheduleRequest),
			typeof(RescheduleResponse),
			typeof(ResetUserFiltersRequest),
			typeof(ResetUserFiltersResponse),
			typeof(ResourceInfo),
			typeof(RetrieveAbsoluteAndSiteCollectionUrlRequest),
			typeof(RetrieveAbsoluteAndSiteCollectionUrlResponse),
			typeof(RetrieveAllChildUsersSystemUserRequest),
			typeof(RetrieveAllChildUsersSystemUserResponse),
			typeof(RetrieveApplicationRibbonRequest),
			typeof(RetrieveApplicationRibbonResponse),
			typeof(RetrieveAttributeChangeHistoryRequest),
			typeof(RetrieveAttributeChangeHistoryResponse),
			typeof(RetrieveAuditDetailsRequest),
			typeof(RetrieveAuditDetailsResponse),
			typeof(RetrieveAuditPartitionListRequest),
			typeof(RetrieveAuditPartitionListResponse),
			typeof(RetrieveAvailableLanguagesRequest),
			typeof(RetrieveAvailableLanguagesResponse),
			typeof(RetrieveBusinessHierarchyBusinessUnitRequest),
			typeof(RetrieveBusinessHierarchyBusinessUnitResponse),
			typeof(RetrieveByGroupResourceRequest),
			typeof(RetrieveByGroupResourceResponse),
			typeof(RetrieveByResourceResourceGroupRequest),
			typeof(RetrieveByResourceResourceGroupResponse),
			typeof(RetrieveByResourcesServiceRequest),
			typeof(RetrieveByResourcesServiceResponse),
			typeof(RetrieveByTopIncidentProductKbArticleRequest),
			typeof(RetrieveByTopIncidentProductKbArticleResponse),
			typeof(RetrieveByTopIncidentSubjectKbArticleRequest),
			typeof(RetrieveByTopIncidentSubjectKbArticleResponse),
			typeof(RetrieveChannelAccessProfilePrivilegesRequest),
			typeof(RetrieveChannelAccessProfilePrivilegesResponse),
			typeof(RetrieveCurrentOrganizationRequest),
			typeof(RetrieveCurrentOrganizationResponse),
			typeof(RetrieveDependenciesForDeleteRequest),
			typeof(RetrieveDependenciesForDeleteResponse),
			typeof(RetrieveDependenciesForUninstallRequest),
			typeof(RetrieveDependenciesForUninstallResponse),
			typeof(RetrieveDependentComponentsRequest),
			typeof(RetrieveDependentComponentsResponse),
			typeof(RetrieveDeploymentLicenseTypeRequest),
			typeof(RetrieveDeploymentLicenseTypeResponse),
			typeof(RetrieveDeprovisionedLanguagesRequest),
			typeof(RetrieveDeprovisionedLanguagesResponse),
			typeof(RetrieveDuplicatesRequest),
			typeof(RetrieveDuplicatesResponse),
			typeof(RetrieveEntityRibbonRequest),
			typeof(RetrieveEntityRibbonResponse),
			typeof(RetrieveExchangeRateRequest),
			typeof(RetrieveExchangeRateResponse),
			typeof(RetrieveFilteredFormsRequest),
			typeof(RetrieveFilteredFormsResponse),
			typeof(RetrieveFormattedImportJobResultsRequest),
			typeof(RetrieveFormattedImportJobResultsResponse),
			typeof(RetrieveFormXmlRequest),
			typeof(RetrieveFormXmlResponse),
			typeof(RetrieveInstalledLanguagePacksRequest),
			typeof(RetrieveInstalledLanguagePacksResponse),
			typeof(RetrieveInstalledLanguagePackVersionRequest),
			typeof(RetrieveInstalledLanguagePackVersionResponse),
			typeof(RetrieveLicenseInfoRequest),
			typeof(RetrieveLicenseInfoResponse),
			typeof(RetrieveLocLabelsRequest),
			typeof(RetrieveLocLabelsResponse),
			typeof(RetrieveMailboxTrackingFoldersRequest),
			typeof(RetrieveMailboxTrackingFoldersResponse),
			typeof(RetrieveMembersBulkOperationRequest),
			typeof(RetrieveMembersBulkOperationResponse),
			typeof(RetrieveMembersTeamRequest),
			typeof(RetrieveMembersTeamResponse),
			typeof(RetrieveMissingComponentsRequest),
			typeof(RetrieveMissingComponentsResponse),
			typeof(RetrieveMissingDependenciesRequest),
			typeof(RetrieveMissingDependenciesResponse),
			typeof(RetrieveOrganizationResourcesRequest),
			typeof(RetrieveOrganizationResourcesResponse),
			typeof(RetrieveParentGroupsResourceGroupRequest),
			typeof(RetrieveParentGroupsResourceGroupResponse),
			typeof(RetrieveParsedDataImportFileRequest),
			typeof(RetrieveParsedDataImportFileResponse),
			typeof(RetrievePersonalWallRequest),
			typeof(RetrievePersonalWallResponse),
			typeof(RetrievePrincipalAccessRequest),
			typeof(RetrievePrincipalAccessResponse),
			typeof(RetrievePrincipalAttributePrivilegesRequest),
			typeof(RetrievePrincipalAttributePrivilegesResponse),
			typeof(RetrievePrincipalSyncAttributeMappingsRequest),
			typeof(RetrievePrincipalSyncAttributeMappingsResponse),
			typeof(RetrievePrivilegeSetRequest),
			typeof(RetrievePrivilegeSetResponse),
			typeof(RetrieveProductPropertiesRequest),
			typeof(RetrieveProductPropertiesResponse),
			typeof(RetrieveProvisionedLanguagePackVersionRequest),
			typeof(RetrieveProvisionedLanguagePackVersionResponse),
			typeof(RetrieveProvisionedLanguagesRequest),
			typeof(RetrieveProvisionedLanguagesResponse),
			typeof(RetrieveRecordChangeHistoryRequest),
			typeof(RetrieveRecordChangeHistoryResponse),
			typeof(RetrieveRecordWallRequest),
			typeof(RetrieveRecordWallResponse),
			typeof(RetrieveRequiredComponentsRequest),
			typeof(RetrieveRequiredComponentsResponse),
			typeof(RetrieveRolePrivilegesRoleRequest),
			typeof(RetrieveRolePrivilegesRoleResponse),
			typeof(RetrieveSharedPrincipalsAndAccessRequest),
			typeof(RetrieveSharedPrincipalsAndAccessResponse),
			typeof(RetrieveSubGroupsResourceGroupRequest),
			typeof(RetrieveSubGroupsResourceGroupResponse),
			typeof(RetrieveSubsidiaryTeamsBusinessUnitRequest),
			typeof(RetrieveSubsidiaryTeamsBusinessUnitResponse),
			typeof(RetrieveSubsidiaryUsersBusinessUnitRequest),
			typeof(RetrieveSubsidiaryUsersBusinessUnitResponse),
			typeof(RetrieveTeamPrivilegesRequest),
			typeof(RetrieveTeamPrivilegesResponse),
			typeof(RetrieveTeamsSystemUserRequest),
			typeof(RetrieveTeamsSystemUserResponse),
			typeof(RetrieveUnpublishedMultipleRequest),
			typeof(RetrieveUnpublishedMultipleResponse),
			typeof(RetrieveUnpublishedRequest),
			typeof(RetrieveUnpublishedResponse),
			typeof(RetrieveUserPrivilegesRequest),
			typeof(RetrieveUserPrivilegesResponse),
			typeof(RetrieveUserQueuesRequest),
			typeof(RetrieveUserQueuesResponse),
			typeof(RetrieveUserSettingsSystemUserRequest),
			typeof(RetrieveUserSettingsSystemUserResponse),
			typeof(RetrieveVersionRequest),
			typeof(RetrieveVersionResponse),
			typeof(RevertProductRequest),
			typeof(RevertProductResponse),
			typeof(ReviseQuoteRequest),
			typeof(ReviseQuoteResponse),
			typeof(RevokeAccessRequest),
			typeof(RevokeAccessResponse),
			typeof(RibbonLocationFilters),
			typeof(RolePrivilege),
			typeof(RolePrivilegeAuditDetail),
			typeof(RollupRequest),
			typeof(RollupResponse),
			typeof(RollupType),
			typeof(RouteToRequest),
			typeof(RouteToResponse),
			typeof(SearchByBodyKbArticleRequest),
			typeof(SearchByBodyKbArticleResponse),
			typeof(SearchByKeywordsKbArticleRequest),
			typeof(SearchByKeywordsKbArticleResponse),
			typeof(SearchByTitleKbArticleRequest),
			typeof(SearchByTitleKbArticleResponse),
			typeof(SearchDirection),
			typeof(SearchRequest),
			typeof(SearchResponse),
			typeof(SearchResults),
			typeof(SendBulkMailRequest),
			typeof(SendBulkMailResponse),
			typeof(SendEmailFromTemplateRequest),
			typeof(SendEmailFromTemplateResponse),
			typeof(SendEmailRequest),
			typeof(SendEmailResponse),
			typeof(SendFaxRequest),
			typeof(SendFaxResponse),
			typeof(SendTemplateRequest),
			typeof(SendTemplateResponse),
			typeof(SetBusinessEquipmentRequest),
			typeof(SetBusinessEquipmentResponse),
			typeof(SetBusinessSystemUserRequest),
			typeof(SetBusinessSystemUserResponse),
			typeof(SetLocLabelsRequest),
			typeof(SetLocLabelsResponse),
			typeof(SetParentBusinessUnitRequest),
			typeof(SetParentBusinessUnitResponse),
			typeof(SetParentSystemUserRequest),
			typeof(SetParentSystemUserResponse),
			typeof(SetParentTeamRequest),
			typeof(SetParentTeamResponse),
			typeof(SetProcessRequest),
			typeof(SetProcessResponse),
			typeof(SetRelatedRequest),
			typeof(SetRelatedResponse),
			typeof(SetReportRelatedRequest),
			typeof(SetReportRelatedResponse),
			typeof(SetStateRequest),
			typeof(SetStateResponse),
			typeof(ShareAuditDetail),
			typeof(SubCode),
			typeof(TargetFieldType),
			typeof(TimeCode),
			typeof(TimeInfo),
			typeof(TraceInfo),
			typeof(TransformImportRequest),
			typeof(TransformImportResponse),
			typeof(TriggerServiceEndpointCheckRequest),
			typeof(TriggerServiceEndpointCheckResponse),
			typeof(UninstallSampleDataRequest),
			typeof(UninstallSampleDataResponse),
			typeof(UnlockInvoicePricingRequest),
			typeof(UnlockInvoicePricingResponse),
			typeof(UnlockSalesOrderPricingRequest),
			typeof(UnlockSalesOrderPricingResponse),
			typeof(UnpublishDuplicateRuleRequest),
			typeof(UnpublishDuplicateRuleResponse),
			typeof(UpdateProductPropertiesRequest),
			typeof(UpdateProductPropertiesResponse),
			typeof(UpdateSolutionComponentRequest),
			typeof(UpdateSolutionComponentResponse),
			typeof(UpdateUserSettingsSystemUserRequest),
			typeof(UpdateUserSettingsSystemUserResponse),
			typeof(UserAccessAuditDetail),
			typeof(UtcTimeFromLocalTimeRequest),
			typeof(UtcTimeFromLocalTimeResponse),
			typeof(ValidateRecurrenceRuleRequest),
			typeof(ValidateRecurrenceRuleResponse),
			typeof(ValidateRequest),
			typeof(ValidateResponse),
			typeof(ValidateSavedQueryRequest),
			typeof(ValidateSavedQueryResponse),
			typeof(ValidationResult),
			typeof(WhoAmIRequest),
			typeof(WhoAmIResponse),
			typeof(WinOpportunityRequest),
			typeof(WinOpportunityResponse),
			typeof(WinQuoteRequest),
			typeof(WinQuoteResponse),
		};

		/// <summary>
		/// Serializable types.
		/// </summary>
		private static readonly Type[] CustomTypes =
		{
			typeof(KeyedRequest),
			typeof(RetrieveSingleRequest),
			typeof(RetrieveSingleResponse),
			typeof(FetchMultipleRequest),
			typeof(CachedOrganizationRequest)
		};

		/// <summary>
		/// Serializable types.
		/// </summary>
		private static readonly Type[] FetchTypes =
		{
			// fetch
			typeof(Condition),
			typeof(Fetch),
			typeof(FetchAttribute),
			typeof(FetchEntity),
			typeof(Filter),
			typeof(Link),
			typeof(Order),
			typeof(FetchExpression),
		};

		/// <summary>
		/// Serializable types.
		/// </summary>
		private static readonly Type[] SurrogateTypes =
		{
			typeof(JsonGuid),
			typeof(JsonEntityFilters),
			typeof(JsonCondition),
			typeof(JsonList<KeyValuePair<Relationship, EntityCollection>>),
			typeof(JsonList<KeyValuePair<Relationship, QueryBase>>),
			typeof(Dictionary<string, object>),
			typeof(Dictionary<string, string>),
			typeof(Dictionary<DeletedMetadataFilters, DataCollection<Guid>>),
			typeof(List<object>),
		};

		#endregion

		/// <summary>
		/// All serializable types.
		/// </summary>
		private static readonly IEnumerable<Type> KnownTypes
			= AttributeTypes
			.Concat(QueryTypes)
			.Concat(MetadataEnumTypes)
			.Concat(ContractKnownTypes)
			.Concat(ContractTypes)
			.Concat(ProxyTypes)
			.Concat(CustomTypes)
			.Concat(FetchTypes)
			.Concat(SurrogateTypes)
			.Concat(CrmJsonConverter.CanConvertBaseTypes)
			.Concat(CrmJsonConverter.CanConvertTypes)
			.ToList();

		/// <summary>
		/// Resolves serializable types.
		/// </summary>
		/// <param name="assemblyName">The source assembly.</param>
		/// <param name="typeName">The source type.</param>
		/// <returns>The resulting type.</returns>
		public override Type BindToType(string assemblyName, string typeName)
		{
			if (string.IsNullOrWhiteSpace(assemblyName) && string.IsNullOrWhiteSpace(typeName))
			{
				return null;
			}

			var type = KnownTypes.FirstOrDefault(t => t.ToString() == typeName);
			
			if (type == null)
			{
				throw new InvalidOperationException(string.Format("The type '{0}, {1}' cannot be deserialized.", typeName, assemblyName));
			}

			return type;
		}

		/// <summary>
		/// Resolves type name.
		/// </summary>
		/// <param name="serializedType">The type to serialize.</param>
		/// <param name="assemblyName">The assembly name.</param>
		/// <param name="typeName">The type name.</param>
		public override void BindToName(Type serializedType, out string assemblyName, out string typeName)
		{
			assemblyName = serializedType.Assembly.GetName().Name;
			typeName = serializedType.ToString();
		}
	}
}
